\chapter{Partitioning hexagonal toruses}
	
	\label{sec:partitioning}
	
	The nodes in super computer networks are usually relatively small, for
	example a single chip. Typically tens of nodes are packed together into a
	single unit such as a circuit board or server blade to simplify assembly
	and share common power and cooling resources \cite{gilge14,ajima12}. In
	commercial super computers built on non-hexagonal torus topologies, each
	unit's nodes represent a hypercube partition of the overall topology as
	illustrated in figure \ref{fig:hypercube-partitioning}
	\cite{chen11,ajima12}.
	
	The majority of commercial
	super computers use torus topologies partitioned into hypercubes
	\cite{chen11,ajima12}.
	
	\begin{figure}
		\center
		\begin{subfigure}[b]{0.45\textwidth}
			\center
			\buildfig{figures/hypercube-partitioning.tex}
			\caption{2D hypercube partitioning}
			\label{fig:apdx-hypercube-partitioning}
		\end{subfigure}
		\begin{subfigure}[b]{0.45\textwidth}
			\center
			\buildfig{figures/parallelogram-partitioning.tex}
			\caption{Parallelogram partitioning}
			\label{fig:apdx-parallelogram-partitioning}
		\end{subfigure}
		
		\caption{Conventional hypercube topology partitioning (a) and the
		hexagonal torus topology analogue (b).}
		\label{fig:apdx-partitioning-options}
	\end{figure}
	
	One possible analogue in a hexagonal torus topology is a parallelogram as
	illustrated in figure \ref{fig:parallelogram-partitioning}.
	
	Each partition connects to six neighbouring partitions and, unlike
	hypercube partitions, the number of connections to each is imbalanced.
	Specifically the partitions above-right and below-left are connected by
	only one link each. The consequence is potentially a need for multiple
	types of interconnect for connecting partitioned pieces of the system,
	adding both to design complexity and cost.
	
	Another `obvious' choice of partition is that of a hexagon wrapped in
	concentric layers of hexagons as illustrated in figure
	\ref{fig:wrapped-hexagon-tiling}.
	
	\begin{figure}
		\center
		\buildfig{figures/wrapped-hexagon-tiling.tex}
		
		\caption{A single hexagon wrapped in layers of hexagons does not tile the
		same way as a pointy-topped hexagon.}
		\label{fig:wrapped-hexagon-tiling}
	\end{figure}
	
	While this partition presents six equally-sized edges, it cannot be used
	to build a hexagonal torus as described. A partition constructed from
	pointy-topped hexagons tiles a hexagonal torus topology constructed from
	pointy-topped hexagons iff the partition tiles with a translational
	symmetry shared with a hexagonal torus. As we can see from the figure,
	this is not the case. This tiles more like a twisted torus of some sort.
	To prove this test is legit, see figure \ref{fig:parallelogram-tiling}
	where we superimpose a pointy-topped hexagon on a parallelogram.
	
	\begin{figure}
		\center
		\buildfig{figures/parallelogram-tiling.tex}
		
		\caption{Demonstration that a parallelogram partition tiles a hexagonal
		torus.}
		\label{fig:parallelogram-tiling}
	\end{figure}
	
	Furber, Davison \emph{et al.} \cite{davidsonWiring} proposed an
	alternative based on wrapped triples where you take three hexagons and
	wrap more layers around them as required. This pattern tiles like
	flat-topped hexagons, which isn't quite right. But since we know a
	pointy-topped triple tiles like a flat-topped hexagon, a flat-topped
	triple must tile like a pointy-topped hexagon. Combining these facts
	gives that by tiling triads of wrapped triples we can tile a hexagonal
	torus.
	
	\begin{figure}
		\center
		\buildfig{figures/wrapped-triple-tiling.tex}
		
		\caption{Three pointy-topped hexagons tiles in the same way as flat-topped
		hexagons.}
		\label{fig:wrapped-triple-tiling}
	\end{figure}
	
	\begin{figure}
		\center
		\buildfig{figures/triad-tiling.tex}
		
		\caption{Demonstration that a triad tiles a hexagonal torus topology.}
		\label{fig:triad-tiling}
	\end{figure}
